$(document).ready(function(){var e;$("#table_id").css("opacity","0"),$("#dataform").css("opacity","0");var t="https://script.google.com/macros/s/AKfycbybPK4-gD6ianBfnIRsY432blVGG_TiPl7S1LmkRBBu_HlnEQ79iTZXlayvgsUcY8tbag/exec";function a(e,a,o,c,n,l,m,i,p){a=a,o=o,c=c,n=n,l=l,m=m,i=i,p=p;"open1"==(e=e)&&$.ajax({url:t+"?callback=ctrlq&id="+a+"&clientname="+o+"&marketplace="+c+"&typeofwork="+n+"&meetingtime="+l+"&accountmanger="+m+"&status="+i+"&comment="+p+"&action=follwupopen",type:"GET",datatype:"json",success:function(e){location.reload()}}),"open2"==e&&$.ajax({url:t+"?callback=ctrlq&id="+a+"&clientname="+o+"&marketplace="+c+"&typeofwork="+n+"&meetingtime="+l+"&accountmanger="+m+"&status="+i+"&comment="+p+"&action=completeopen",type:"GET",datatype:"json",success:function(e){location.reload()}}),"open3"==e&&$.ajax({url:t+"?callback=ctrlq&id="+a+"&clientname="+o+"&marketplace="+c+"&typeofwork="+n+"&meetingtime="+l+"&accountmanger="+m+"&status="+i+"&comment="+p+"&action=canceltoopen",type:"GET",datatype:"json",success:function(e){location.reload()}}),"followup1"==e&&$.ajax({url:t+"?callback=ctrlq&id="+a+"&clientname="+o+"&marketplace="+c+"&typeofwork="+n+"&meetingtime="+l+"&accountmanger="+m+"&status="+i+"&comment="+p+"&action=masterfollowup",type:"GET",datatype:"json",success:function(e){location.reload()}}),"followup2"==e&&$.ajax({url:t+"?callback=ctrlq&id="+a+"&clientname="+o+"&marketplace="+c+"&typeofwork="+n+"&meetingtime="+l+"&accountmanger="+m+"&status="+i+"&comment="+p+"&action=completefollw",type:"GET",datatype:"json",success:function(e){location.reload()}}),"followup3"==e&&$.ajax({url:t+"?callback=ctrlq&id="+a+"&clientname="+o+"&marketplace="+c+"&typeofwork="+n+"&meetingtime="+l+"&accountmanger="+m+"&status="+i+"&comment="+p+"&action=cancelfollwup",type:"GET",datatype:"json",success:function(e){location.reload()}}),"complete1"==e&&$.ajax({url:t+"?callback=ctrlq&id="+a+"&clientname="+o+"&marketplace="+c+"&typeofwork="+n+"&meetingtime="+l+"&accountmanger="+m+"&status="+i+"&comment="+p+"&action=mastercomplete",type:"GET",datatype:"json",success:function(e){location.reload()}}),"complete2"==e&&$.ajax({url:t+"?callback=ctrlq&id="+a+"&clientname="+o+"&marketplace="+c+"&typeofwork="+n+"&meetingtime="+l+"&accountmanger="+m+"&status="+i+"&comment="+p+"&action=follwupcomplete",type:"GET",datatype:"json",success:function(e){location.reload()}}),"complete3"==e&&$.ajax({url:t+"?callback=ctrlq&id="+a+"&clientname="+o+"&marketplace="+c+"&typeofwork="+n+"&meetingtime="+l+"&accountmanger="+m+"&status="+i+"&comment="+p+"&action=cancelcomplete",type:"GET",datatype:"json",success:function(e){location.reload()}}),"cancel1"==e&&$.ajax({url:t+"?callback=ctrlq&id="+a+"&clientname="+o+"&marketplace="+c+"&typeofwork="+n+"&meetingtime="+l+"&accountmanger="+m+"&status="+i+"&comment="+p+"&action=mastercancel",type:"GET",datatype:"json",success:function(e){location.reload()}}),"cancel2"==e&&$.ajax({url:t+"?callback=ctrlq&id="+a+"&clientname="+o+"&marketplace="+c+"&typeofwork="+n+"&meetingtime="+l+"&accountmanger="+m+"&status="+i+"&comment="+p+"&action=follwupcancel",type:"GET",datatype:"json",success:function(e){location.reload()}}),"cancel3"==e&&$.ajax({url:t+"?callback=ctrlq&id="+a+"&clientname="+o+"&marketplace="+c+"&typeofwork="+n+"&meetingtime="+l+"&accountmanger="+m+"&status="+i+"&comment="+p+"&action=completecancel",type:"GET",datatype:"json",success:function(e){location.reload()}})}$.ajax({url:t,type:"GET",datatype:"json",success:function(t){e=t,table=$("#table_id").DataTable({data:t.user,columns:[{data:"date"},{data:"id"},{data:"clientname"},{data:"marketplace"},{data:"typeofwork"},{data:"meetingtime"},{data:"accountmanger"},{data:"status"},{data:"comment"}],columnDefs:[{targets:9,data:null,render:function(e){return"Open"==e.status?'<button class="followup1">Followup</button><button class="complete1">Complete</button><button class="cancel1">Cancel</button>':"Followup"==e.status?'<button class="open1">Open</button><button class="complete2">Complete</button><button class="cancel2">Cancel</button>':"Complete"==e.status?'<button class="open2">Open</button><button class="followup2">Followup</button><button class="cancel3">Cancel</button>':"Cancel"==e.status?'<button class="open3">Open</button><button class="followup3">Followup</button><button class="complete3">Complete</button>':void 0}}],order:[[2,"asce"]]}),table.columns().every(function(){var e=this,t=$('<select><option value=""></option></select>').appendTo($("thead tr:eq(1) td").eq(this.index())).on("change",function(){e.search($(this).val()).draw()}),a=(this.data().sort().map(function(e){return e.toString().toLowerCase().replace(/\b\w/g,function(e){return e.toUpperCase()})}).unique().each(function(e){t.append($("<option>"+e+"</option>"))}),this.state.loaded());if(a){var o=a.columns[this.index()];t.val(o.search.search)}})},complete:function(){$("#loader").hide(),$("#table_id").css("opacity","1"),$("#dataform").css("opacity","1")}}),$("#table_id").on("click","button",function(){$(".followup1").prop("disabled",!0),$(".followup2").prop("disabled",!0),$(".followup3").prop("disabled",!0),$(".complete1").prop("disabled",!0),$(".complete2").prop("disabled",!0),$(".complete3").prop("disabled",!0),$(".cancel1").prop("disabled",!0),$(".cancel2").prop("disabled",!0),$(".cancel3").prop("disabled",!0),$(".open1").prop("disabled",!0),$(".open2").prop("disabled",!0),$(".open3").prop("disabled",!0);var e=this.className,t=table.row($(this).parents("tr")).data();"open1"==e&&a(e,t.id,t.clientname,t.marketplace,t.typeofwork,t.meetingtime,t.accountmanger,"Open",t.comment);"open2"==e&&a(e,t.id,t.clientname,t.marketplace,t.typeofwork,t.meetingtime,t.accountmanger,"Open",t.comment);"open3"==e&&a(e,t.id,t.clientname,t.marketplace,t.typeofwork,t.meetingtime,t.accountmanger,"Open",t.comment);"followup1"==e&&a(e,t.id,t.clientname,t.marketplace,t.typeofwork,t.meetingtime,t.accountmanger,"Followup",t.comment);"followup2"==e&&a(e,t.id,t.clientname,t.marketplace,t.typeofwork,t.meetingtime,t.accountmanger,"Followup",t.comment);"followup3"==e&&a(e,t.id,t.clientname,t.marketplace,t.typeofwork,t.meetingtime,t.accountmanger,"Followup",t.comment);"complete1"==e&&a(e,t.id,t.clientname,t.marketplace,t.typeofwork,t.meetingtime,t.accountmanger,"Complete",t.comment);"complete2"==e&&a(e,t.id,t.clientname,t.marketplace,t.typeofwork,t.meetingtime,t.accountmanger,"Complete",t.comment);"complete3"==e&&a(e,t.id,t.clientname,t.marketplace,t.typeofwork,t.meetingtime,t.accountmanger,"Complete",t.comment);"cancel1"==e&&a(e,t.id,t.clientname,t.marketplace,t.typeofwork,t.meetingtime,t.accountmanger,"Cancel",t.comment);"cancel2"==e&&a(e,t.id,t.clientname,t.marketplace,t.typeofwork,t.meetingtime,t.accountmanger,"Cancel",t.comment);"cancel3"==e&&a(e,t.id,t.clientname,t.marketplace,t.typeofwork,t.meetingtime,t.accountmanger,"Cancel",t.comment)}),$("#submitdata").click(function(){const a=[];var o,c;for(o=0;o<e.user.length;o++)a[o]=e.user[o].id;var n=a.reduce(function(e,t){return Math.max(e,t)});if(c=n+1,a.includes(c))alert("Id Already Exist");else{var l=c,m=$("#clientname").val(),i=$("#marketplace").val(),p=$("#typeofwork").val(),r=$("#meetingtime").val(),s=$("#accountmanger").val(),u=$("#status option:selected").text(),d=$("#comment").val();null!=p&&null!=u&&(null!=p&&null!=u)&&(""!=p&&""!=u)?($("#submitdata").prop("disabled",!0),$.ajax({url:t+"?callback=ctrlq&id="+l+"&clientname="+m+"&marketplace="+i+"&typeofwork="+p+"&meetingtime="+r+"&accountmanger="+s+"&status="+u+"&comment="+d+"&action=masterdataenter",type:"GET",datatype:"json",success:function(e){location.reload()}})):alert("Please Fill Type of Work")}})});